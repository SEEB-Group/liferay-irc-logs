--- Log opened Thu Apr 24 00:00:44 2014
10:07 < sm`> Hello
10:07 < sm`> anyone around to help me out with exposing custom json web serivice from existing liferay plugin?
10:10 < bijoo_> sm`: have you added  @WebService here?
10:10 < sm`> here's my exception, web.xml and service.xml
10:10 < sm`> http://pastebin.com/43vYTfPj
10:10 < bijoo_> @JSONWebService ****
10:11 < sm`> im following https://www.liferay.com/documentation/liferay-portal/6.1/development/-/ai/json-web-services
10:11 < sm`> yes i basiccally added new service
10:11 < sm`> edited service.xml, built the service
10:12 < sm`> added @JSONWebService on the ServiceImpl class
10:12 < sm`> edited web.xml like the documentation says
10:12 < sm`> rebuilt the service again
10:12 < sm`> packed it in .war
10:12 < sm`> and deployed it
10:12 < bijoo_> sm`: okay, have you tried it while login there? Try logging in as the Admin and try.
10:12 < sm`> i can see the service its there, but when i try to make a call to it, i get the exception
10:13 < sm`> bijoo, i did, im logged in as admin
10:13 < sm`> bijoo_ *
10:13 < sm`> :)
10:14 < topolik> sm`: what URL do you call?
10:14 < topolik> from the documentation: "There are two ways to access a plugin’s JSON Web Services. We’ll call them, ingeniously, Option 1 and Option 2."
10:17 < sm`> topolik: http://dwww/StoreFinder-portlet/api/jsonws/storefinderapi/get-store-types?p_auth=caeP8svu
10:17 < topolik> this is the "Option 1"
10:17 < topolik> if you call it from JS it won't work
10:18 < sm`> im calling it with simple browser get request
10:18 < topolik> hmm
10:18 < topolik> Liferay 6.1?
10:18 < sm`> yep
10:18 < topolik> what exception you get?
10:18 < sm`> wait, there is some new exception when i restart the server
10:19 < sm`> http://pastebin.com/cgL5PJbQ
10:19 < sm`> topolik: http://pastebin.com/43vYTfPj you can see the exception, web.xml and service.xml here
10:20 < sm`> [not sure if i should paste here] ;]
10:20 < topolik> that's ok
10:21 < topolik> the problem with UserImpl seems to be related to session serialization
10:22 < topolik> com.liferay.portal.kernel.bean.BeanLocatorException: BeanLocator has not been set for servlet context StoreFinder-portlet
10:22 < topolik> This is a problem in your spring definition
10:24 < topolik> I'm not sure now how it is when you have your custom spring definition + use ServiceBuilder, which also use Spring config files, but other config files
10:24 < sm`> im using my own applicationContext.xml which defines my spring beans
10:24 < sm`> i have <context:component-scan base-package="com.iwmn.storefinder" />
10:25 < sm`> the service pkg is under that one
10:27 < topolik> hmm
10:27 < bijoo_> sm`: another approach is more simpler: Liferay.Service.*.*.method
10:27 < topolik> there could 2 ways, don't know which would work :)
10:28 < topolik> can you try to remove the ContextLoaderListener and /WEB-INF/applicationContext.xml from your web.xml
10:28 < topolik> and declare the spring beans in ext-spring.xml file?
10:28 < topolik> ext-spring.xml should be generated by service builder
10:28 < bijoo_> sm`: go to your portal, open up console; type in Liferay.Service.(press tab)  ; see if your service is registered there.
10:29 < bijoo_> sm`: note you'd have to have service.js
10:29 < sm`> topolic, basically move my contents from my app.xml to ext-spring.xml, right?
10:30 < sm`> bijoo_, thats not the issue bro the web method is throwing me different exception
10:30 < sm`> i can see the method and the webservice there, yies
10:31 < topolik> sm`: yup, it's possible that your spring declaration collides with service builder spring declarations
10:31 < bijoo_> sm`: right that way it abstracts little details; you may want to try it that way to check.
10:32 < sm`> topolik, but i dont see ext-spring.xml in the WEB-INF dir
10:33 < topolik> service builder should generate it into WEB-INF/src/META-INF/ext-spring.xml
10:33 < sm`> maybe i can add my spring conf
10:33 < sm`> in the service.rpoperties file
10:33 < sm`> spring.configs=
10:33 < sm`> ?
10:34 < topolik> yes, this sounds good
10:34 < sm`> service.properties
10:37 < sm`> wow, do i really need all this .xml configurations in the META-INF folder?
10:38 < sm`> :D
10:38 < topolik> hmm, that's a good point!
10:39 < topolik> I'm not sure how exactly JSONWS works but as long as you don't use DB, transactions, *Util classes and use only the service for JSONWS, you could delete most of the stuff
10:40 < topolik> but I'd not touch it until it's working :)
10:40 < bijoo_> sm`: great question; I tread that as black magic. It'd be nice to have better docs on that.
10:40 < bijoo_> sm`: though if you read through it, they start make sense.
10:40 < bijoo_> sm`: pretty sure you need it if use SB
10:41 < sm`> i havent used it till now to be hones
10:41 < sm`> ive been defining my own spirng+hibernate .xmls
10:42 < sm`> honest*
10:45 < bijoo_> sm`: so own spring+hibernate for all the things? so just using SB for the JSON?
10:45 < bijoo_> so no local SB persistence then? if so need to set 'local-service="false"' in service.xml
10:46 < bijoo_> sm`: then maybe it'lll behave with those chopped off
10:46 < sm`> ill try that too
10:46 < sm`> added my spring conf file to service.properties
10:46 < sm`> lets see wassup
10:46 < sm`> ;]
10:47 < bijoo_> sm`: and you said you went to 'http://localhost:8080/[plugin-context]/api/jsonws' and saw the services listed?
10:47 < sm`> yes
10:47 < sm`> i get the exception when i try to run it
10:48 < bijoo_> sm`: oh I see what you mean here; okay.
10:48 < bijoo_> sm`: yea so agree with topolik on beans; likely a wiring issue here
10:50 < sm`> no luck with changing spring.configs=
10:52 < sm`> btw i dont see ext-spring.xml in META-INF, only: base-spring.xml, cluster-spring.xml, dynamic-data-source-spring.xml, hibernate-spring.xml, portlet-hbm.xml, portlet-model-hintes.xml, portlet-orm.xml, portlet-sring.xml, shard-data-source-spring.xml
10:53 < bijoo_> sm`: I think you have to create that if need.
10:56 < topolik> don't forget to remove the declarations from web.xml
10:57 < sm`> tried em both
10:57 < sm`> should i rebuild the service
10:58 < topolik> hmm, can you try to move WEB-INF/applicationContext.xml to the src dir so that it's on classpath?
10:58 < topolik> e.g. move it into src/META-INF so that it's together with the other configs
10:58 < sm`> yeah
10:58 < topolik> and then change the spring.configs to include it?
10:58 < sm`> good idea
10:58 < sm`> afte i change service.properties
10:59 < sm`> should i rebuild the service
10:59 < topolik> hmm, i'm not sure
10:59 < sm`> i assume no, cuz it generates new service.rpoperties
10:59 < sm`> without my change
10:59 < topolik> exactly :D
10:59 < topolik> and it would also help to check the generated web.xml in the tomcat/webapps/your-portlet/WEB-INF
11:00 < topolik> to see that there is only liferay PortletContextListener or PluginContextListener or what's used in 6.1
11:00 < bijoo_> sm`: may also want to check these properties http://pastebin.com/71iRAy7Z
11:01 < topolik> bijoo_: these won't help with the spring issue
11:02 < sm`> k, move the applicationContext.xml in the same dir with the .xmls SB generated
